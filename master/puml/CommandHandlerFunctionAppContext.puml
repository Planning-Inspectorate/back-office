@startuml
set separator none
title Function App - Command Handler

left to right direction

!include <C4/C4>
!include <C4/C4_Context>
!include <C4/C4_Container>
!include <C4/C4_Component>

Container(CBOSCaseworkBackOfficeSystem.CBOSFilestorage, "CBOS File storage", $techn="", $descr="(application-service-uploads) - Azure Blob Storage Container that contains all documents and document versions in CBOS", $tags="", $link="")
Container(CBOSCaseworkBackOfficeSystem.FrontOfficeSubmissionsFilestorage, "Front Office Submissions File storage", $techn="", $descr="(application-submission-documents) - Azure Blob Storage Container that contains documents submitted from Front Office, also accessible by CBOS", $tags="", $link="")
Container(CBOSCaseworkBackOfficeSystem.WebCBOSAPI, "Web CBOS API", $techn="Node.js, Azure Web App", $descr="CBOS API to perform CRUD operations on NSIP cases, documents, S51 Advice, Relevant Representations, Exam Timetables etc, on the database, and broadcast events to the Azure Service Bus", $tags="", $link="")

Container_Boundary("CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp_boundary", "Command Handler Function App", $tags="") {
  Component(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessFrontOfficeDeadineSubmissions, "Process Front Office Deadine Submissions", $techn="Function App, JavaScript", $descr="Process written submissions from the Front Office", $tags="", $link="")
  Component(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ForceTestaDeadineSubmission, "Force Test a Deadine Submission", $techn="Function App, JavaScript", $descr="Process written submissions from the Front Office", $tags="", $link="")
  Component(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessFrontOfficeSubscriptions, "Process Front Office Subscriptions", $techn="Function App, JavaScript", $descr="Process Email Subscription Updates from Front Office", $tags="", $link="")
  Component(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessRelevantRepresentations, "Process Relevant Representations", $techn="Function App, JavaScript", $descr="Process Relevant Representatios from Front Office", $tags="", $link="")
}

Rel(CBOSCaseworkBackOfficeSystem.WebCBOSAPI, CBOSCaseworkBackOfficeSystem.CBOSFilestorage, "Reads and writes applications documents to", $techn="", $tags="", $link="")
Rel(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessFrontOfficeDeadineSubmissions, CBOSCaseworkBackOfficeSystem.WebCBOSAPI, "Creates document records", $techn="", $tags="", $link="")
Rel(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessFrontOfficeDeadineSubmissions, CBOSCaseworkBackOfficeSystem.FrontOfficeSubmissionsFilestorage, "Reads documents submitted via Front Office", $techn="", $tags="", $link="")
Rel(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessFrontOfficeDeadineSubmissions, CBOSCaseworkBackOfficeSystem.CBOSFilestorage, "Writes documents submitted via Front Office into CBOS", $techn="", $tags="", $link="")
Rel(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessFrontOfficeSubscriptions, CBOSCaseworkBackOfficeSystem.WebCBOSAPI, "Creates and updates email subscription records", $techn="", $tags="", $link="")
Rel(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessRelevantRepresentations, CBOSCaseworkBackOfficeSystem.WebCBOSAPI, "Creates relevant representation records", $techn="", $tags="", $link="")
Rel(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ForceTestaDeadineSubmission, CBOSCaseworkBackOfficeSystem.FrontOfficeSubmissionsFilestorage, "Write a test document", $techn="", $tags="", $link="")
Rel(CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ForceTestaDeadineSubmission, CBOSCaseworkBackOfficeSystem.CommandHandlerFunctionApp.ProcessFrontOfficeDeadineSubmissions, "Broadcast a test Deadline Submission message", $techn="Azure Service Bus Topic deadline-submission-topic", $tags="", $link="")

SHOW_LEGEND(true)
@enduml