import got from 'got';
import config from './config.js';
/**
 * @param {*} info
 * @param {*} status
 * @returns {Promise<{id: string | null}>}
 */
async function patch(info, status) {
	try {
		const version = info.version.replace('v', '');
		const payload = {
			documents: [
				{
					id: info.id,
					version,
					virusCheckStatus: status
				}
			]
		};

		const result = await got
			.post(`https://${config.API_HOST}/appeals/documents/avcheck`, {
				json: payload
			})
			.json();

		return result;
	} catch (err) {
		throw new Error(`post document submission failed with error: ${err}`);
	}
}

export default {
	patch
};
