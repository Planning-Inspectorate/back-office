openapi: "3.0.3"
info:
  description: "Documentation for the PINS Back Office API"
  version: "1.0.0"
  title: "PINS Back Office API"
servers:
  - url: 'http://localhost:3004'
paths:
  "/api/v1/appeal":
    post:
      tags:
        - "/api/v1/appeal"
      summary: "Creates a new record in the HASAppeal table"
      description: "Creates a new record in the HASAppeal table. This endpoint calls the CreateHASAppeal procedure which fetches the latest record in the HASAppeal table, merges with the submitted data and creates a new record flagged as the latest."
      operationId: "postAppeal"
      requestBody:
        description: "Can contain the data for a full or partial record. The appealId field is the only required field. Unrecognised properties will be ignored."
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                appealId:
                  type: "string"
                  example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                creatorEmailAddress:
                  type: "string"
                  example: "agent@example.com"
      responses:
        "200":
          description: "Valid request"
        "404":
          description: "Not found"
    get:
      tags:
        - "/api/v1/appeal"
      summary: "Returns all data for all Appeals"
      description: "Returns all data for all Appeals. This endpoint calls the AppealData view which includes data from the HASAppealSubmission, AppealLink and other joined tables."
      operationId: "getAppeal"
      responses:
        "200":
          description: "Valid request"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    appealId:
                      type: "string"
                      example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                    creatorEmailAddress:
                      type: "string"
                      example: "agent@example.com"
                    creatorName:
                      type: "string"
                      example: "An Agent"
                    creatorOriginalApplicant:
                      type: "boolean"
                      example: true
                    creatorOnBehalfOf:
                      type: "string"
                      example: ""
                    originalApplicationNumber:
                      type: "string"
                      example: "ABC/123/12345"
                    siteOwnership:
                      type: "boolean"
                      example: true
                    siteInformOwners:
                      type: "boolean"
                      example: true
                    siteRestriction:
                      type: "boolean"
                      example: true
                    siteRestrictionDetails:
                      type: "string"
                      example: "Details of site restriction"
                    safetyConcern:
                      type: "boolean"
                      example: true
                    safetyConcernDetails:
                      type: "string"
                      example: "Details of safety concern"
                    sensitiveInformation:
                      type: "boolean"
                      example: true
                    termsAgreed:
                      type: boolean
                      example: true
                    appealDecisionDate:
                      type: "string"
                      example: "2021-11-12T00:00:00.000Z"
                    submissionDate:
                      type: "string"
                      example: "2021-11-10T00:00:00.000Z"
                    caseReference:
                      type: "integer"
                      example: 123456789
                    caseStatusId:
                      type: "integer"
                      example: 1
                    appellantName:
                      type: "string"
                      example: "An Apellant"
                    siteAddressLineOne:
                      type: "string"
                      example: "Address 1"
                    siteAddressLineTwo:
                      type: "string"
                      example: "Address 2"
                    siteAddressTown:
                      type: "string"
                      example: "Town"
                    siteAddressCounty:
                      type: "string"
                      example: "Country"
                    siteAddressPostCode:
                      type: "string"
                      example: "Postcode"
                    localPlanningAuthorityId:
                      type: "string"
                      example: "E69999999"
                    caseOfficerFirstName:
                      type: "string"
                      example: "First Name"
                    caseOfficerSurname:
                      type: "string"
                      example: "Surname"
                    caseOfficerEmail:
                      type: "string"
                      example: "caseofficer@planninginspectorate.gov.uk"
                    validationOfficerFirstName:
                      type: "string"
                      example: "First Name"
                    validationOfficerSurname:
                      type: "string"
                      example: "Surname"
                    validationOfficerEmail:
                      type: "string"
                      example: "validationofficer@planninginspectorate.gov.uk"
                    invalidReasonOtherDetails:
                      type: "string"
                      example: "Other Details"
                    invalidAppealReasons:
                      type: "string"
                      example: "'[1,3]'"
                    inspectorFirstName:
                      type: "string"
                      example: "First name"
                    inspectorSurname:
                      type: "string"
                      example: "Surname"
                    inspectorEmail:
                      type: "string"
                      example: "inspector@planninginspectorate.gov.uk"
                    scheduledSiteVisitDate:
                      type: "string"
                      example: "2021-11-10"
                    questionnaireDecisionDate:
                      type: "string"
                      example: "2021-11-16"
                    descriptionDevelopment:
                      type: "string"
                      example: "Description of the development"
                    appealStartDate:
                      type: "string"
                      example: "2021-11-05"
                    appealValidationDate:
                      type: "string"
                      example: "2021-11-16"
                    caseTypeName:
                      type: "string"
                      example: "Householder Appeal (HAS)"
                    caseStageName:
                      type: "string"
                      example: "Received"
                    caseStatusName:
                      type: "string"
                      example: "Appeal Received"
                    recommendedSiteVisitTypeName:
                      type: "string"
                      example: "Unaccompanied"
                    siteVisitTypeName:
                      type: "string"
                      example: "Accompanied"
                    inspectorSpecialismName:
                      type: "string"
                      example: "General"
                    decisionOutcomeName:
                      type: "string"
                      example: "Allowed"
        "404":
          description: "Not found"
  "/api/v1/appeal/{appealId}":
    get:
      tags:
        - "/api/v1/appeal"
      summary: "Returns all data for an Appeal"
      description: "Returns all data for an Appeal. This endpoint calls the AppealData view which includes data from the HASAppealSubmission, AppealLink and other joined tables. It also includes the metadata for the documents of the Appeal."
      parameters:
        - name: "appealId"
          in: "path"
          description: "The appeal id"
          schema:
            type : "string"
            format: "string"
            minimum: 1
          required: true
      operationId: "getSingleAppeal"
      responses:
        "200":
          description: "Valid request"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  appealId:
                    type: "string"
                    example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                  creatorEmailAddress:
                    type: "string"
                    example: "agent@example.com"
                  creatorName:
                    type: "string"
                    example: "An Agent"
                  creatorOriginalApplicant:
                    type: "boolean"
                    example: true
                  creatorOnBehalfOf:
                    type: "string"
                    example: ""
                  originalApplicationNumber:
                    type: "string"
                    example: "ABC/123/12345"
                  siteOwnership:
                    type: "boolean"
                    example: true
                  siteInformOwners:
                    type: "boolean"
                    example: true
                  siteRestriction:
                    type: "boolean"
                    example: true
                  siteRestrictionDetails:
                    type: "string"
                    example: "Details of site restriction"
                  safetyConcern:
                    type: "boolean"
                    example: true
                  safetyConcernDetails:
                    type: "string"
                    example: "Details of safety concern"
                  sensitiveInformation:
                    type: "boolean"
                    example: true
                  termsAgreed:
                    type: boolean
                    example: true
                  appealDecisionDate:
                    type: "string"
                    example: "2021-11-12T00:00:00.000Z"
                  submissionDate:
                    type: "string"
                    example: "2021-11-10T00:00:00.000Z"
                  caseReference:
                    type: "integer"
                    example: 123456789
                  caseStatusId:
                    type: "integer"
                    example: 1
                  appellantName:
                    type: "string"
                    example: "An Apellant"
                  siteAddressLineOne:
                    type: "string"
                    example: "Address 1"
                  siteAddressLineTwo:
                    type: "string"
                    example: "Address 2"
                  siteAddressTown:
                    type: "string"
                    example: "Town"
                  siteAddressCounty:
                    type: "string"
                    example: "Country"
                  siteAddressPostCode:
                    type: "string"
                    example: "Postcode"
                  localPlanningAuthorityId:
                    type: "string"
                    example: "E69999999"
                  caseOfficerFirstName:
                    type: "string"
                    example: "First Name"
                  caseOfficerSurname:
                    type: "string"
                    example: "Surname"
                  caseOfficerEmail:
                    type: "string"
                    example: "caseofficer@planninginspectorate.gov.uk"
                  validationOfficerFirstName:
                    type: "string"
                    example: "First Name"
                  validationOfficerSurname:
                    type: "string"
                    example: "Surname"
                  validationOfficerEmail:
                    type: "string"
                    example: "validationofficer@planninginspectorate.gov.uk"
                  invalidReasonOtherDetails:
                    type: "string"
                    example: "Other Details"
                  invalidAppealReasons:
                    type: "string"
                    example: "'[1,3]'"
                  inspectorFirstName:
                    type: "string"
                    example: "First name"
                  inspectorSurname:
                    type: "string"
                    example: "Surname"
                  inspectorEmail:
                    type: "string"
                    example: "inspector@planninginspectorate.gov.uk"
                  scheduledSiteVisitDate:
                    type: "string"
                    example: "2021-11-10"
                  questionnaireDecisionDate:
                    type: "string"
                    example: "2021-11-16"
                  descriptionDevelopment:
                    type: "string"
                    example: "Description of the development"
                  appealStartDate:
                    type: "string"
                    example: "2021-11-05"
                  appealValidationDate:
                    type: "string"
                    example: "2021-11-16"
                  caseTypeName:
                    type: "string"
                    example: "Householder Appeal (HAS)"
                  caseStageName:
                      type: "string"
                      example: "Received"
                  caseStatusName:
                    type: "string"
                    example: "Appeal Received"
                  recommendedSiteVisitTypeName:
                    type: "string"
                    example: "Unaccompanied"
                  siteVisitTypeName:
                    type: "string"
                    example: "Accompanied"
                  inspectorSpecialismName:
                    type: "string"
                    example: "General"
                  decisionOutcomeName:
                    type: "string"
                    example: "Allowed"
                  documents:
                    type: "array"
                    items:
                      type: "object"
                      properties:
                        application_id:
                          type: "string"
                          example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                        name:
                          type: "string"
                          example: "PDF test.pdf"
                        upload_date:
                          type: "string"
                          example: "2021-11-03T09:03:08.147Z"
                        mime_type:
                          type: "string"
                          example: "application/pdf"
                        location:
                          type: "string"
                          example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b/07d04a19-af9c-4294-932d-5fd484424d40/PDF test.pdf"
                        size:
                          type: "string"
                          example: "471164"
                        id:
                          type: "string"
                          example: "07d04a19-af9c-4294-932d-5fd484424d40"
                        document_type:
                          type: "string"
                          example: "originalApplication"
        "404":
          description: "Not found"
  "/api/v1/appeal-link":
    post:
      tags:
        - "/api/v1/appeal-link"
      summary: "Creates a new record in the HASAppealLink table"
      description: "Creates a new record in the HASAppealLink table. This endpoint calls the CreateAppealLink procedure which fetches the latest record in the AppealLink table, merges with the submitted data and creates a new record flagged as the latest."
      operationId: "postAppealLink"
      requestBody:
        description: "Can contain the data for a full or partial record. The appealId field is the only required field. Unrecognised properties will be ignored."
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                appealId:
                  type: "string"
                  example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                appellantName:
                  type: "string"
                  example: "An Appellant"
      responses:
        "200":
          description: "Valid request"
        "404":
          description: "Not found"
  "/api/v1/appeal-submission":
    post:
      tags:
        - "/api/v1/appeal-submission"
      summary: "Creates a new record in the HASAppealSubmission table"
      description: "Creates a new record in the HASAppealSubmission table. This endpoint calls the CreateAppealSubmission procedure which fetches the latest record in the HASAppealSubmission table, merges with the submitted data and creates a new record flagged as the latest."
      operationId: "postAppealSubmission"
      requestBody:
        description: "Can contain the data for a full or partial record. The appealId field is the only required field. Unrecognised properties will be ignored."
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                appealId:
                  type: "string"
                  example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                creatorName:
                  type: "string"
                  example: "An Appellant"
      responses:
        "200":
          description: "Valid request"
        "404":
          description: "Not found"
  "/api/v1/questionnaire":
    post:
      tags:
      - "/api/v1/questionnaire"
      summary: "Creates a new record in the HASLPASubmission table"
      description: "Creates a new record in the HASLPASubmission table. This endpoint calls the CreateHASLPASubmission procedure which fetches the latest record in the HASLPASubmission table, merges with the submitted data and creates a new record flagged as the latest."
      operationId: "postQuestionnaire"
      requestBody:
        description: "Can contain the data for a full or partial record. The appealId field is the only required field. Unrecognised properties will be ignored."
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                appealId:
                  type: "string"
                  example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                submissionAccuracyDetails:
                  type: "string"
                  example: "Details abotu the submission accuracy"
      responses:
        "200":
          description: "Valid request"
        "404":
          description: "Not found"
    get:
      tags:
        - "/api/v1/questionnaire"
      summary: "Returns all data for all Questionnaires"
      description: "Returns all data for all Questionnaires. This endpoint calls the QuestionnaireData view which includes data from the HASLPASubmission, AppealLink and other joined tables."
      operationId: "getQuestionnaire"
      responses:
        "200":
          description: "Valid request"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    lpaQuestionnaireId:
                      type: "string"
                      example: "5c45c22d-a39c-4844-bee1-2f6829b42238"
                    appealId:
                      type: "string"
                      example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                    submissionDate:
                      type: "string"
                      example: "2021-11-12T00:00:00.000Z"
                    submissionAccuracy:
                      type: "boolean"
                      example: true
                    submissionAccuracyDetails:
                      type: "string"
                      example: "Accuracy details"
                    extraConditions:
                      type: "boolean"
                      example: true
                    extraConditionsDetails:
                      type: "string"
                      example: "Extra details"
                    adjacentAppeals:
                      type: "boolean"
                      example: true
                    adjacentAppealsNumbers:
                      type: "string"
                      example: "Appeals Numbers"
                    cannotSeeLand:
                      type: "boolean"
                      example: true
                    siteAccess:
                      type: "boolean"
                      example: true
                    siteAccessDetails:
                      type: "string"
                      example: "Site access details"
                    siteNeighbourAccess:
                      type: "boolean"
                      example: true
                    siteNeighbourAccessDetails:
                      type: "string"
                      example: "Access details"
                    healthAndSafetyIssues:
                      type: "boolean"
                      example: true
                    healthAndSafetyDetails:
                      type: "string"
                      example: "Safety issues"
                    affectListedBuilding:
                      type: "boolean"
                      example: true
                    affectListedBuildingDetails:
                      type: "string"
                      example: "Building details"
                    greenBelt:
                      type: "boolean"
                      example: true
                    conservationArea:
                      type: "boolean"
                      example: true
                    originalPlanningApplicationPublicised:
                      type: "boolean"
                      example: true
                    developmentNeighbourhoodPlanSubmitted:
                      type: "boolean"
                      example: true
                    developmentNeighbourhoodPlanChanges:
                      type: "string"
                      example: "Plan changes"
                    caseReference:
                      type: "integer"
                      example: 123456789
                    appellantName:
                      type: "string"
                      example: "An Apellant"
                    siteAddressLineOne:
                      type: "string"
                      example: "Address 1"
                    siteAddressLineTwo:
                      type: "string"
                      example: "Address 2"
                    siteAddressTown:
                      type: "string"
                      example: "Town"
                    siteAddressCounty:
                      type: "string"
                      example: "Country"
                    siteAddressPostCode:
                      type: "string"
                      example: "Postcode"
                    localPlanningAuthorityId:
                      type: "string"
                      example: "E69999999"
                    questionnaireStatus:
                      type: "string"
                      example: "Overdue"
                    caseTypeName:
                      type: "string"
                      example: "Householder Appeal (HAS)"
                    caseStageName:
                      type: "string"
                      example: "Received"
                    caseStatusName:
                      type: "string"
                      example: "Appeal Received"
                    localPlanningAuthorityName:
                      type: "string"
                      example: "System Test Borough Council"
                    lpaQuestionnaireOutcomeName:
                      type: "string"
                      example: "Complete"
        "404":
          description: "Not found"
  "/api/v1/questionnaire/{appealId}":
    get:
      tags:
        - "/api/v1/questionnaire"
      summary: "Returns all data for a Questionnaire"
      description: "Returns all data for a Questionnaire. This endpoint calls the QuestionnaireData view which includes data from the HASLPASubmission, AppealLink and other joined tables. It also includes the metadata for the documents of the Questionnaire."
      parameters:
        - name: appealId
          in: path
          description: The appeal id
          schema:
            type : "string"
            format: "string"
            minimum: 1
          required: true
      operationId: "getSingleQuestionnaire"
      responses:
        "200":
          description: "Valid request"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    lpaQuestionnaireId:
                      type: "string"
                      example: "5c45c22d-a39c-4844-bee1-2f6829b42238"
                    appealId:
                      type: "string"
                      example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                    submissionDate:
                      type: "string"
                      example: "2021-11-12T00:00:00.000Z"
                    submissionAccuracy:
                      type: "boolean"
                      example: true
                    submissionAccuracyDetails:
                      type: "string"
                      example: "Accuracy details"
                    extraConditions:
                      type: "boolean"
                      example: true
                    extraConditionsDetails:
                      type: "string"
                      example: "Extra details"
                    adjacentAppeals:
                      type: "boolean"
                      example: true
                    adjacentAppealsNumbers:
                      type: "string"
                      example: "Appeals Numbers"
                    cannotSeeLand:
                      type: "boolean"
                      example: true
                    siteAccess:
                      type: "boolean"
                      example: true
                    siteAccessDetails:
                      type: "string"
                      example: "Site access details"
                    siteNeighbourAccess:
                      type: "boolean"
                      example: true
                    siteNeighbourAccessDetails:
                      type: "string"
                      example: "Access details"
                    healthAndSafetyIssues:
                      type: "boolean"
                      example: true
                    healthAndSafetyDetails:
                      type: "string"
                      example: "Safety issues"
                    affectListedBuilding:
                      type: "boolean"
                      example: true
                    affectListedBuildingDetails:
                      type: "string"
                      example: "Building details"
                    greenBelt:
                      type: "boolean"
                      example: true
                    conservationArea:
                      type: "boolean"
                      example: true
                    originalPlanningApplicationPublicised:
                      type: "boolean"
                      example: true
                    developmentNeighbourhoodPlanSubmitted:
                      type: "boolean"
                      example: true
                    developmentNeighbourhoodPlanChanges:
                      type: "string"
                      example: "Plan changes"
                    caseReference:
                      type: "integer"
                      example: 123456789
                    appellantName:
                      type: "string"
                      example: "An Apellant"
                    siteAddressLineOne:
                      type: "string"
                      example: "Address 1"
                    siteAddressLineTwo:
                      type: "string"
                      example: "Address 2"
                    siteAddressTown:
                      type: "string"
                      example: "Town"
                    siteAddressCounty:
                      type: "string"
                      example: "Country"
                    siteAddressPostCode:
                      type: "string"
                      example: "Postcode"
                    localPlanningAuthorityId:
                      type: "string"
                      example: "E69999999"
                    questionnaireStatus:
                      type: "string"
                      example: "Overdue"
                    caseTypeName:
                      type: "string"
                      example: "Householder Appeal (HAS)"
                    caseStageName:
                      type: "string"
                      example: "Received"
                    caseStatusName:
                      type: "string"
                      example: "Appeal Received"
                    localPlanningAuthorityName:
                      type: "string"
                      example: "System Test Borough Council"
                    lpaQuestionnaireOutcomeName:
                      type: "string"
                      example: "Complete"
                    documents:
                      type: "array"
                      items:
                        type: "object"
                        properties:
                          application_id:
                            type: "string"
                            example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b"
                          name:
                            type: "string"
                            example: "PDF test.pdf"
                          upload_date:
                            type: "string"
                            example: "2021-11-03T09:03:08.147Z"
                          mime_type:
                            type: "string"
                            example: "application/pdf"
                          location:
                            type: "string"
                            example: "6ff8d0ef-3767-4258-b3d3-34d48fca238b/07d04a19-af9c-4294-932d-5fd484424d40/PDF test.pdf"
                          size:
                            type: "string"
                            example: "471164"
                          id:
                            type: "string"
                            example: "07d04a19-af9c-4294-932d-5fd484424d40"
                          document_type:
                            type: "string"
                            example: "originalApplication"
        "404":
          description: "Not found"