{% extends "layouts/form.njk" %}

{% from "govuk/components/checkboxes/macro.njk" import govukCheckboxes %}
{% from "components/button-group.njk" import buttonGroup %}
{% from "govuk/components/input/macro.njk" import govukInput %}

{% set otherError = errors['other-reason'].msg %}

{% block formContent %}
  <p class="govuk-body">Appeal reference: {{appealReference}}</p>

  {% set otherHtml %}
    {{ govukInput({
      id: "other-reason",
      name: "other-reason",
      value: outcomeDetails.otherReason,
      label: {
        text: "List reasons"
      },
      hint: {
        text: "This will be sent to the appellant and LPA"
      },
      errorMessage: otherError and {
        text: otherError
      }
    }) }}
  {% endset %}

  {{ govukCheckboxes({
    idPrefix: "invalid-appeal-reasons",
    name: "invalid-appeal-reasons",
    fieldset: {
      legend: {
        text: "Reasons the appeal is invalid",
        classes: "govuk-fieldset__legend--m"
      }
    },
    errorMessage: errors['invalid-appeal-reasons'] and {
      text: errors['invalid-appeal-reasons'].msg
    },
    items: [
      {
        value: "outOfTime",
        text: getText("outOfTime"),
        checked: invalidAppealDetails and invalidAppealDetails.reasons and invalidAppealDetails.reasons.includes('outOfTime')
      },
      {
        value: "noRightOfAppeal",
        text: getText("noRightOfAppeal"),
        checked: invalidAppealDetails and invalidAppealDetails.reasons and invalidAppealDetails.reasons.includes('noRightOfAppeal')
      },
      {
        value: "notAppealable",
        text: getText("notAppealable"),
        checked: invalidAppealDetails and invalidAppealDetails.reasons and invalidAppealDetails.reasons.includes('notAppealable')
      },
      {
        value: "lpaDeemedApplicationAsInvalid",
        text: getText("lpaDeemedApplicationAsInvalid"),
        checked: invalidAppealDetails and invalidAppealDetails.reasons and invalidAppealDetails.reasons.includes('lpaDeemedApplicationAsInvalid')
      },
      {
        value: "other",
        text: getText("other"),
        checked: invalidAppealDetails and invalidAppealDetails.reasons and invalidAppealDetails.reasons.includes('other'),
        conditional: {
          html: otherHtml
        }
      }
    ]
  }) }}

  {{ buttonGroup(backLink) }}
{% endblock %}
