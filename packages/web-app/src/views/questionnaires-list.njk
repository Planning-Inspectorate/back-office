{% extends "layouts/main.njk" %}

{% from "govuk/components/table/macro.njk" import govukTable %}

{% set questionnairesListDisplayData = [] %}

{% for questionnaire in sortedQuestionnairesData %}
  {% if questionnaire.status.text === "Received" %}
    {% set reference = "<a class='govuk-link' href=\"questionnaires-for-review/review/" + questionnaire.id + "\">" + questionnaire.reference + "</a>"%}
  {% else %}
    {% set reference = questionnaire.reference%}
  {% endif %}

  {% set status %}
    <strong class="govuk-tag govuk-tag--{{ questionnaire.status.colour }}">
      {{ questionnaire.status.text }}
    </strong>
  {% endset %}
  
  {% set questionnairesListDisplayData = (questionnairesListDisplayData.push([
    { html: reference},
    { text: questionnaire.dueDate },
    { text: questionnaire.site },
    { html: status, classes: 'govuk-table__cell govuk-table__cell--numeric' }
  ]), questionnairesListDisplayData) %}
{% endfor %}

{% block backButton %}
{% endblock %}

{% block content %}
  <h1 class="govuk-heading-xl">{{ pageTitle }}</h1>

  {{ govukTable({
    head: [
      { text: "Appeal reference" },
      { text: "Due date" },
      { text: "Appeal site" },
      { text: "Status" }
    ],
    rows: questionnairesListDisplayData
  }) }}
{% endblock %}
