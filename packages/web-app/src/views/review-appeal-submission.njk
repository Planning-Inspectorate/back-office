{% extends "layouts/form.njk" %}

{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "components/address.njk" import address %}
{% from "components/unorderedList.njk" import unorderedList %}
{% from "components/button.njk" import button %}

{% set yourDetails = appealData.aboutYouSection.yourDetails %}
{% set originalApplicationFile = appealData.requiredDocumentsSection.originalApplication.uploadedFile %}
{% set decisionLetterFile = appealData.requiredDocumentsSection.decisionLetter.uploadedFile %}
{% set appealStatementFile = appealData.yourAppealSection.appealStatement.uploadedFile %}

{% block formContent %}
  {{ govukSummaryList({
    rows: [
      {
        key: { text: "Appellant name" },
        value: { text: yourDetails.name if yourDetails.isOriginalApplicant else yourDetails.appealingOnBehalfOf }
      },
      { key: { text: "Appeal reference" },
        value: { text: appealData.horizonId }
      },
      {
        key: { text: "Received on" },
        value: { text: appealData.submissionDate | date }
      },
      {
        key: { text: "Appeal site" },
        value: { html: address(appealData.appealSiteSection.siteAddress) }
      },
      {
        key: { text: "Local planning department" },
        value: { text: appealData.lpaCode }
      },
      {
        key: { text: "Planning application reference" },
        value: { text: appealData.requiredDocumentsSection.applicationNumber }
      }
    ]
  }) }}

  <h2 class="govuk-heading-l govuk-!-margin-top-9">Planning application documents</h2>

  {{ govukSummaryList({
    rows: [
      {
        key: { text: "Planning application form" },
        value: { html: '<a class="govuk-link" href="/document/'+appealData.id+'/'+originalApplicationFile.id+'">' + originalApplicationFile.name + '</a>' }
      },
      {
        key: { text: "Decision letter" },
        value: { html: '<a a class="govuk-link" href="/document/'+appealData.id+'/'+decisionLetterFile.id+'">' + decisionLetterFile.name + '</a>' }
      }
    ]
  }) }}

  <h2 class="govuk-heading-l govuk-!-margin-top-9">Appeal documents</h2>

  {{ govukSummaryList({
    rows: [
      {
        key: { text: "Appeal statement" },
        value: { html: '<a a class="govuk-link" href="/document/'+appealData.id+'/'+appealStatementFile.id+'">' + appealStatementFile.name + '</a>' }
      },
      {
        key: { text: "Supporting documents" },
        value: { html: unorderedList(appealData.yourAppealSection.otherDocuments.uploadedFiles, '/document/'+appealData.id) }
      }
    ]
  }) }}

  {{ govukRadios({
    idPrefix: "review-outcome",
    name: "review-outcome",
    errorMessage: errors['review-outcome'] and { text: errors['review-outcome'].msg },
    fieldset: {
      legend: {
        text: "Outcome of review",
        isPageHeading: false,
        classes: "govuk-fieldset__legend--l govuk-!-margin-top-6"
      }
    },
    items: [
      { value: "valid", text: "Valid", checked: reviewOutcome === 'valid' },
      { value: "invalid", text: "Invalid", checked: reviewOutcome === 'invalid' },
      { divider: "or" },
      { value: "incomplete", text: "Something is missing or wrong", checked: reviewOutcome === 'incomplete' }
    ]
  }) }}

  {{ button() }}
{% endblock %}
