{% extends "layouts/form.njk" %}

{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "components/address.njk" import address %}
{% from "components/unorderedList.njk" import unorderedList %}
{% from "components/button.njk" import button %}

{% block formContent %}
  {{ govukSummaryList({
    rows: [
      {
        key: { text: "Appellant name" },
        value: { text: appealData.appellantName if appealData.creatorOriginalApplicant else appealData.creatorName }
      },
      { key: { text: "Appeal reference" },
        value: { text: appealData.caseReference }
      },
      {
        key: { text: "Received on" },
        value: { text: appealData.submissionDate | date }
      },
      {
        key: { text: "Appeal site" },
        value: { html: address({
          addressLine1: appealData.siteAddressLineOne,
          addressLine2: appealData.siteAddressLineTwo,
          town: appealData.siteAddressTown,
          county: appealData.siteAddressCounty,
          postcode: appealData.siteAddressPostCode
        }) }
      },
      {
        key: { text: "Local planning department" },
        value: { text: appealData.localPlanningAuthorityId }
      },
      {
        key: { text: "Planning application reference" },
        value: { text: appealData.caseReference }
      }
    ]
  }) }}

  <h2 class="govuk-heading-l govuk-!-margin-top-9">Planning application documents</h2>

  {{ govukSummaryList({
    rows: [
      {
        key: { text: "Planning application form" },
        value: { html: '<a class="govuk-link" href="/document/'+appealData.appealId+'/'+appealData.originalApplication.id+'">' + appealData.originalApplication.name + '</a>' }
      },
      {
        key: { text: "Decision letter" },
        value: { html: '<a a class="govuk-link" href="/document/'+appealData.appealId+'/'+appealData.decisionLetter.id+'">' + appealData.decisionLetter.name + '</a>' }
      }
    ]
  }) }}

  <h2 class="govuk-heading-l govuk-!-margin-top-9">Appeal documents</h2>

  {{ govukSummaryList({
    rows: [
      {
        key: { text: "Appeal statement" },
        value: { html: '<a a class="govuk-link" href="/document/'+appealData.appealId+'/'+appealData.appealStatement.id+'">' + appealData.appealStatement.name + '</a>' }
      },
      {
        key: { text: "Supporting documents" },
        value: { html: unorderedList(appealData.otherDocuments, '/document/'+appealData.appealId) }
      }
    ]
  }) }}

  {{ govukRadios({
    idPrefix: "review-outcome",
    name: "review-outcome",
    errorMessage: errors['review-outcome'] and { text: errors['review-outcome'].msg },
    fieldset: {
      legend: {
        text: "Outcome of review",
        isPageHeading: false,
        classes: "govuk-fieldset__legend--l govuk-!-margin-top-6"
      }
    },
    items: [
      { value: "valid", text: "Valid", checked: reviewOutcome === 'valid' },
      { value: "invalid", text: "Invalid", checked: reviewOutcome === 'invalid' },
      { divider: "or" },
      { value: "incomplete", text: "Something is missing or wrong", checked: reviewOutcome === 'incomplete' }
    ]
  }) }}

  {{ button() }}
{% endblock %}
