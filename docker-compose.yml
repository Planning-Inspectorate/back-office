# Port ranges (by convention):
#  - API: 3000-3999
#  - Services: 4000-4999
#  - Websites: 9000-9999
#
# Please run `make install` to get the dependencies install

version: "3.7"
services:
  web-app:
    container_name: web-app
    image: node:14-alpine
    ports:
      - 9004:3000
    working_dir: /opt/app
    volumes:
      - ./packages/common:/opt/app/node_modules/@pins/common
      - ./packages/web-app:/opt/app
    command: npm run start:dev
    environment:
      DOCUMENTS_SERVICE_API_URL: http://document-service-api:3000
      LOGGER_LEVEL: 'debug'
      SRV_NOTIFY_START_EMAIL_TO_LPA_TEMPLATE_ID: 'c4701212-4b6a-4b55-801a-c86c7dbea54b'
      SRV_NOTIFY_EMAIL_REPLYTO_ID_START_EMAIL_TO_LPA: '937b4147-8420-42da-859d-d4a65bdf99bc'
      APP_LPA_QUESTIONNAIRE_BASE_URL: http://lpa-questionnaire-web-app:9001
      SRV_NOTIFY_BASE_URL: http://mock-notify:3000
      SRV_NOTIFY_SERVICE_ID: 'dummy-service-id-for-notify'
      SRV_NOTIFY_API_KEY: 'dummy-api-key-for-notify'
      BACK_OFFICE_API_URL: http://api:3000

  api:
    container_name: api
    image: node:14-alpine
    ports:
      - 3004:3000
    working_dir: /opt/app
    volumes:
      - ./packages/common:/opt/app/node_modules/@pins/common
      - ./packages/api:/opt/app
    command: npm run start:dev
    environment:
      MSSQL_DATABASE: backofficedev
      MSSQL_USERNAME: sa
      MSSQL_PASSWORD: AbCd12345@~
      MSSQL_HOST: sql-server-db
      MSSQL_DIALECT: mssql
      LOGGER_LEVEL: debug
      DOCUMENTS_SERVICE_API_URL: http://document-service-api:3000

  sql-server-db:
    container_name: sql-server-db
    image: mcr.microsoft.com/mssql/server:2019-latest
    ports:
      - 1433:1433
    environment:
      SA_PASSWORD: AbCd12345@~
      ACCEPT_EULA: Y

networks:
  default:
    name: appeal-planning-decision_default
    external: true
