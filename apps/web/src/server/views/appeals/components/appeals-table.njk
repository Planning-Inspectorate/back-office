{%- from "govuk/components/table/macro.njk" import govukTable -%}
{%- from "./status-tag.njk" import statusTag -%}

{%- macro appealsTable(params) -%}
	{%- macro createReferenceCell(appeal) -%}
		<a class="govuk-link" href="/appeals-service/validation/appeals/{{appeal.AppealId}}">
			{{ appeal.AppealReference }}
		</a>
	{%- endmacro -%}
	{%- set rows = [] -%}
	{%- for appeal in params.appeals -%}
		{%- set statusHtml -%}
			{{ 
				statusTag(appeal.AppealStatus)
			}}
		{%- endset -%}
		{%- set row = [
			{ html: createReferenceCell(appeal) },
			{ text: appeal.AppealSite | collapse(', ') },
			{ text: 'Householder Appeal' },
			{ text: 'Bradford Council' },
			{ text: appeal.Received },
			{ html: statusHtml }
		] -%}
		{%- set rows = rows | concat([row]) -%}
	{%- endfor -%}
	{{
		govukTable({
			caption: params.caption,
			captionClasses: "govuk-table__caption--l",
			head: [
				{ text: "Appeal ID" },
				{ text: "Site address" },
				{ text: "Appeal type" },
				{ text: "Local planning authority" },
				{ text: "Date received" },
				{ text: "Status" }
			],
			rows: rows
		})
	}}
{%- endmacro -%}